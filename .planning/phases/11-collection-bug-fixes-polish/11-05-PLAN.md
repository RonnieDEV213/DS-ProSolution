---
phase: 11-collection-bug-fixes-polish
plan: 05
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/components/admin/collection/run-config-modal.tsx
autonomous: true

must_haves:
  truths:
    - "Concurrency slider has visible tick marks at 1-5"
    - "Coming soon placeholder removed"
    - "Slider values labeled clearly"
  artifacts:
    - path: "apps/web/src/components/admin/collection/run-config-modal.tsx"
      provides: "Improved concurrency slider UI"
      contains: "tick"
  key_links:
    - from: "Concurrency slider"
      to: "UI display"
      via: "tick marks"
      pattern: "tick"

# CONCURRENCY EVALUATION (Success Criterion #7)
#
# Current backend settings (apps/api/src/app/services/db_utils.py):
#   - QUERY_BATCH_SIZE = 150 (URL length limit for Supabase)
#   - INSERT_BATCH_SIZE = 500 (optimal for Supabase bulk inserts)
#   - MAX_CONCURRENT = 15 (parallel requests to Oxylabs)
#
# These values are appropriate for the current scale because:
#
# 1. Oxylabs Rate Limits: Oxylabs allows up to 20 concurrent requests per account.
#    MAX_CONCURRENT = 15 leaves headroom for retries and avoids hitting hard limits.
#
# 2. Database Throughput: Supabase handles batch inserts well up to ~500 rows.
#    INSERT_BATCH_SIZE = 500 is tested and stable.
#
# 3. Query Size: QUERY_BATCH_SIZE = 150 stays under URL length limits when
#    filtering by multiple IDs in a single request.
#
# 4. User Control: The UI slider (1-5 workers) is for FUTURE feature where
#    users could choose speed vs cost tradeoff. Currently not wired because:
#    - Single user system (no contention)
#    - Oxylabs pricing is per-request, not per-worker
#    - Hardcoded MAX_CONCURRENT = 15 is already optimal
#
# Decision: Keep slider as visual polish but don't wire to backend until
# there's a concrete use case (e.g., budget-conscious slow mode, or shared
# account with multiple concurrent users).
---

<objective>
Improve concurrency slider UI in run config modal

Purpose: Per CONTEXT.md - add tick marks at 1-5 with labels, remove "Coming soon" placeholder
Output: Clear, usable concurrency slider with proper tick marks
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-collection-bug-fixes-polish/11-CONTEXT.md
@.planning/phases/11-collection-bug-fixes-polish/11-RESEARCH.md
@apps/web/src/components/admin/collection/run-config-modal.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add tick marks to concurrency slider</name>
  <files>apps/web/src/components/admin/collection/run-config-modal.tsx</files>
  <action>
  Per CONTEXT.md: "Concurrency slider: add tick marks at 1, 2, 3, 4, 5 with labels"

  Current slider (around lines 294-309):
  ```tsx
  <div className="space-y-2">
    <div className="flex justify-between">
      <Label className="text-gray-300">Concurrency</Label>
      <span className="text-sm text-gray-500">{concurrency} workers</span>
    </div>
    <Slider
      value={[concurrency]}
      onValueChange={([v]) => setConcurrency(v)}
      min={1}
      max={10}
      step={1}
      className="w-full"
    />
    <p className="text-xs text-gray-500">(Coming soon)</p>
  </div>
  ```

  Replace with:
  ```tsx
  <div className="space-y-2">
    <div className="flex justify-between">
      <Label className="text-gray-300">Concurrency</Label>
      <span className="text-sm text-gray-400">{concurrency} workers</span>
    </div>
    <div className="relative pt-1 pb-4">
      <Slider
        value={[concurrency]}
        onValueChange={([v]) => setConcurrency(v)}
        min={1}
        max={5}
        step={1}
        className="w-full"
      />
      {/* Tick marks and labels */}
      <div className="flex justify-between px-1 mt-1">
        {[1, 2, 3, 4, 5].map((n) => (
          <div key={n} className="flex flex-col items-center">
            <div className="w-px h-1.5 bg-gray-600" />
            <span className={`text-xs mt-0.5 ${concurrency === n ? 'text-blue-400' : 'text-gray-500'}`}>
              {n}
            </span>
          </div>
        ))}
      </div>
    </div>
    <p className="text-xs text-gray-500">
      Higher values = faster collection, more API load
    </p>
  </div>
  ```

  Changes:
  1. Reduced max from 10 to 5 (per CONTEXT.md tick marks at 1-5)
  2. Added tick marks below slider with numbers
  3. Removed "(Coming soon)" placeholder
  4. Added helpful description instead
  5. Highlighted current value in blue

  Note: The slider value is stored in UI state but not wired to the backend.
  This is intentional per the concurrency evaluation in frontmatter - the
  backend's MAX_CONCURRENT = 15 is already optimal for Oxylabs rate limits,
  and there's no current use case for user-controlled throttling.
  </action>
  <verify>
  Run `npm run lint` in apps/web to verify no syntax errors.
  Open run config modal in browser and verify tick marks appear at 1-5.
  </verify>
  <done>
  Concurrency slider has tick marks at 1-5, current value highlighted, helpful description shown
  </done>
</task>

</tasks>

<verification>
- [ ] Slider max changed from 10 to 5
- [ ] Tick marks visible at 1, 2, 3, 4, 5
- [ ] Current value highlighted in blue
- [ ] "(Coming soon)" placeholder removed
- [ ] Helpful description text present
- [ ] No lint errors
</verification>

<success_criteria>
- Concurrency slider UI is polished and usable
- Clear tick marks and labels guide user
- No confusing placeholder text
- Concurrency evaluation documented in plan frontmatter
</success_criteria>

<output>
After completion, create `.planning/phases/11-collection-bug-fixes-polish/11-05-SUMMARY.md`
</output>

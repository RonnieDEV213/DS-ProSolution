---
phase: 30-consistent-skeletons-empty-states
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/components/admin/collection/sellers-grid.tsx
  - apps/web/src/components/admin/collection/history-panel.tsx
  - apps/web/src/components/admin/collection/schedule-config.tsx
  - apps/web/src/components/admin/collection/amazon-category-selector.tsx
autonomous: true

must_haves:
  truths:
    - "Sellers grid shows a grid-shaped skeleton (toolbar + grid cells) instead of 'Loading sellers...' text"
    - "History panel shows inline skeleton list (5 rows) instead of 'Loading...' text"
    - "Schedule config shows a card-shaped skeleton instead of 'Loading schedule...' text"
    - "Amazon category selector shows a grid skeleton instead of 'Loading categories...' text"
  artifacts:
    - path: "apps/web/src/components/admin/collection/sellers-grid.tsx"
      provides: "Sellers grid with grid-shaped skeleton loading state"
      contains: "Skeleton"
    - path: "apps/web/src/components/admin/collection/history-panel.tsx"
      provides: "History panel with inline skeleton loading state"
      contains: "Skeleton"
    - path: "apps/web/src/components/admin/collection/schedule-config.tsx"
      provides: "Schedule config with card-shaped skeleton loading state"
      contains: "Skeleton"
    - path: "apps/web/src/components/admin/collection/amazon-category-selector.tsx"
      provides: "Category selector with skeleton loading state"
      contains: "Skeleton"
  key_links:
    - from: "sellers-grid.tsx"
      to: "components/ui/skeleton.tsx"
      via: "import Skeleton primitive"
      pattern: "import.*Skeleton.*from.*ui/skeleton"
    - from: "history-panel.tsx"
      to: "components/ui/skeleton.tsx"
      via: "import Skeleton primitive"
      pattern: "import.*Skeleton.*from.*ui/skeleton"
---

<objective>
Replace "Loading..." text in all collection page components with inline skeletons that match the shape of the expected content.

Purpose: The collection page is the primary workflow for the application. Sellers grid, history panel, schedule config, and category selector all show plain text during loading -- replacing with shaped skeletons makes the app feel faster and more polished.
Output: 4 collection component files updated with contextual skeleton loading states.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/milestones/v5-ROADMAP.md
@.planning/STATE.md
@.planning/phases/30-consistent-skeletons-empty-states/30-RESEARCH.md
@apps/web/src/components/ui/skeleton.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace sellers grid and history panel "Loading..." with shaped skeletons</name>
  <files>
    apps/web/src/components/admin/collection/sellers-grid.tsx
    apps/web/src/components/admin/collection/history-panel.tsx
  </files>
  <action>
**File 1: `apps/web/src/components/admin/collection/sellers-grid.tsx`**

Add import at top:
```typescript
import { Skeleton } from "@/components/ui/skeleton"
```

Replace lines 1116-1118 (the loading block):
```typescript
// BEFORE (lines 1116-1118):
if (loading) {
  return <div className="text-muted-foreground p-4">Loading sellers...</div>;
}

// AFTER:
if (loading) {
  return (
    <div className="flex flex-col h-full animate-fade-in">
      {/* Toolbar skeleton */}
      <div className="flex items-center justify-between mb-3 gap-2">
        <div className="flex items-center gap-2 flex-1">
          <Skeleton className="h-[38px] w-96" />
          <Skeleton className="h-8 w-8" />
        </div>
        <Skeleton className="h-4 w-32" />
      </div>
      {/* Grid skeleton - matches 4-column grid layout */}
      <div className="grid grid-cols-4 gap-1 flex-1">
        {Array.from({ length: 40 }).map((_, i) => (
          <Skeleton key={i} className="h-8 w-full" />
        ))}
      </div>
    </div>
  );
}
```

This matches the actual layout: search input + add button at top, then a 4-column grid of seller cells.

**File 2: `apps/web/src/components/admin/collection/history-panel.tsx`**

Add import at top:
```typescript
import { Skeleton } from "@/components/ui/skeleton"
```

Replace line 219 (the loading branch inside the JSX):
```typescript
// BEFORE (line 218-219):
{loading ? (
  <div className="text-muted-foreground text-sm">Loading...</div>
)

// AFTER:
{loading ? (
  <div className="space-y-1 animate-fade-in">
    {Array.from({ length: 5 }).map((_, i) => (
      <div key={i} className="px-3 py-1.5 rounded border-l-2 border-border">
        <div className="flex items-center gap-2">
          <Skeleton className="h-4 w-4 rounded" />
          <Skeleton className="h-3 flex-1" />
        </div>
        <Skeleton className="h-2 w-20 mt-1" />
      </div>
    ))}
  </div>
)
```

This matches the shape of history entries: icon + text on first line, timestamp on second line, with the border-l-2 accent matching the real entry styling.
  </action>
  <verify>
1. Grep `sellers-grid.tsx` for "Loading sellers" -- should find ZERO matches
2. Grep `history-panel.tsx` for the string `"Loading..."` -- should find ZERO matches
3. Grep both files for "Skeleton" -- should find import and usage
4. Run `cd /mnt/c/Users/User/Downloads/GitRepos/DS-ProSolution/apps/web && npx tsc --noEmit` to verify no type errors
  </verify>
  <done>
- Sellers grid shows a toolbar + 4-column grid skeleton during loading
- History panel shows 5 skeleton entry rows during loading
- Zero "Loading..." text strings in either file's loading branches
  </done>
</task>

<task type="auto">
  <name>Task 2: Replace schedule config and category selector "Loading..." with shaped skeletons</name>
  <files>
    apps/web/src/components/admin/collection/schedule-config.tsx
    apps/web/src/components/admin/collection/amazon-category-selector.tsx
  </files>
  <action>
**File 1: `apps/web/src/components/admin/collection/schedule-config.tsx`**

Note: This component is marked `@deprecated` (merged into RunConfigModal in Phase 10), but it is still imported and rendered. Update it anyway.

Add import at top:
```typescript
import { Skeleton } from "@/components/ui/skeleton"
```

Replace line 149-151 (the loading guard):
```typescript
// BEFORE (lines 149-151):
if (loading) {
  return <div className="text-muted-foreground">Loading schedule...</div>;
}

// AFTER:
if (loading) {
  return (
    <Card className="bg-card border-border animate-fade-in">
      <CardHeader>
        <div className="flex items-center gap-2">
          <Skeleton className="h-5 w-5 rounded" />
          <Skeleton className="h-5 w-40" />
        </div>
        <Skeleton className="h-4 w-64 mt-1" />
      </CardHeader>
      <CardContent className="space-y-6">
        <div className="flex items-center justify-between">
          <div className="space-y-1">
            <Skeleton className="h-4 w-28" />
            <Skeleton className="h-3 w-52" />
          </div>
          <Skeleton className="h-5 w-9 rounded-full" />
        </div>
        <div className="space-y-2">
          <Skeleton className="h-4 w-24" />
          <Skeleton className="h-9 w-full" />
        </div>
        <div className="space-y-2">
          <Skeleton className="h-4 w-16" />
          <Skeleton className="h-9 w-full" />
        </div>
        <Skeleton className="h-9 w-full" />
      </CardContent>
    </Card>
  );
}
```

This matches the card layout: header with icon + title, toggle, two selects, and a button.

**File 2: `apps/web/src/components/admin/collection/amazon-category-selector.tsx`**

Add import at top:
```typescript
import { Skeleton } from "@/components/ui/skeleton"
```

Replace lines 139-145 (the loading guard):
```typescript
// BEFORE (lines 139-145):
if (loading) {
  return (
    <div className="flex items-center justify-center p-8 text-muted-foreground">
      Loading categories...
    </div>
  );
}

// AFTER:
if (loading) {
  return (
    <div className="space-y-4 animate-fade-in">
      <div className="flex items-center justify-between">
        <Skeleton className="h-4 w-32" />
        <Skeleton className="h-8 w-20" />
      </div>
      <div className="grid grid-cols-2 gap-2">
        {Array.from({ length: 8 }).map((_, i) => (
          <div key={i} className="flex items-center gap-2 p-2">
            <Skeleton className="h-4 w-4 rounded" />
            <Skeleton className="h-4 flex-1" />
          </div>
        ))}
      </div>
    </div>
  );
}
```

This matches the category checkbox grid layout.
  </action>
  <verify>
1. Grep `schedule-config.tsx` for "Loading schedule" -- should find ZERO matches
2. Grep `amazon-category-selector.tsx` for "Loading categories" -- should find ZERO matches
3. Grep both files for "Skeleton" -- should find import and usage
4. Run `cd /mnt/c/Users/User/Downloads/GitRepos/DS-ProSolution/apps/web && npx tsc --noEmit` to verify no type errors
  </verify>
  <done>
- Schedule config shows card-shaped skeleton matching its real layout during loading
- Amazon category selector shows 2-column checkbox grid skeleton during loading
- Zero "Loading..." text strings in either file's loading branches
  </done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `grep -rn "Loading\.\.\.\|Loading sellers\|Loading schedule\|Loading categories" apps/web/src/components/admin/collection/sellers-grid.tsx apps/web/src/components/admin/collection/history-panel.tsx apps/web/src/components/admin/collection/schedule-config.tsx apps/web/src/components/admin/collection/amazon-category-selector.tsx` returns empty
2. TypeScript compiles without errors
3. All 4 files import and use `Skeleton` from `@/components/ui/skeleton`
</verification>

<success_criteria>
- All 4 collection component "Loading..." occurrences replaced with shaped skeletons
- Each skeleton matches the shape of the expected content (grid for grid, list for list, card for card)
- No TypeScript compilation errors
- SKEL-03 partially satisfied (4 more data-loading transitions converted)
</success_criteria>

<output>
After completion, create `.planning/phases/30-consistent-skeletons-empty-states/30-02-SUMMARY.md`
</output>

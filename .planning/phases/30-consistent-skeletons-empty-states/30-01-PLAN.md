---
phase: 30-consistent-skeletons-empty-states
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/app/va/layout.tsx
  - apps/web/src/components/admin/automation/jobs-table.tsx
  - apps/web/src/components/admin/automation/agents-table.tsx
  - apps/web/src/components/admin/automation/pairing-requests-table.tsx
autonomous: true

must_haves:
  truths:
    - "VA layout shows a full-page skeleton (sidebar shell + DashboardSkeleton) instead of 'Loading...' text during role check"
    - "Jobs table shows TableSkeleton with 5 columns and 5 rows instead of 'Loading...' text during initial load"
    - "Agents table shows TableSkeleton with 6 columns and 4 rows instead of 'Loading...' text during initial load"
    - "Pairing requests table shows TableSkeleton with 5 columns and 3 rows instead of 'Loading...' text during initial load"
  artifacts:
    - path: "apps/web/src/app/va/layout.tsx"
      provides: "VA layout with skeleton loading state"
      contains: "DashboardSkeleton"
    - path: "apps/web/src/components/admin/automation/jobs-table.tsx"
      provides: "Jobs table with skeleton loading state"
      contains: "TableSkeleton"
    - path: "apps/web/src/components/admin/automation/agents-table.tsx"
      provides: "Agents table with skeleton loading state"
      contains: "TableSkeleton"
    - path: "apps/web/src/components/admin/automation/pairing-requests-table.tsx"
      provides: "Pairing requests table with skeleton loading state"
      contains: "TableSkeleton"
  key_links:
    - from: "va/layout.tsx"
      to: "components/skeletons/dashboard-skeleton.tsx"
      via: "import and render"
      pattern: "import.*DashboardSkeleton"
    - from: "jobs-table.tsx"
      to: "components/skeletons/table-skeleton.tsx"
      via: "import and render inside TableCell"
      pattern: "import.*TableSkeleton"
---

<objective>
Replace "Loading..." text in all page-level and automation table components with skeleton placeholders.

Purpose: These are the highest-visibility loading states -- the VA layout gate and all three automation sub-tabs. Users see these on every page load before cached data is available.
Output: 4 files updated with skeleton imports and skeleton rendering in loading branches.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/milestones/v5-ROADMAP.md
@.planning/STATE.md
@.planning/phases/30-consistent-skeletons-empty-states/30-RESEARCH.md
@apps/web/src/components/skeletons/table-skeleton.tsx
@apps/web/src/components/skeletons/dashboard-skeleton.tsx
@apps/web/src/components/ui/skeleton.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace VA layout and automation table "Loading..." with skeletons</name>
  <files>
    apps/web/src/app/va/layout.tsx
    apps/web/src/components/admin/automation/jobs-table.tsx
    apps/web/src/components/admin/automation/agents-table.tsx
    apps/web/src/components/admin/automation/pairing-requests-table.tsx
  </files>
  <action>
**File 1: `apps/web/src/app/va/layout.tsx`**

Add imports at top:
```typescript
import { DashboardSkeleton } from "@/components/skeletons/dashboard-skeleton"
import { Skeleton } from "@/components/ui/skeleton"
```

Replace lines 52-58 (the loading block):
```typescript
// BEFORE (lines 52-58):
if (loading) {
  return (
    <div className="min-h-screen flex items-center justify-center bg-background">
      <div className="text-muted-foreground">Loading...</div>
    </div>
  )
}

// AFTER:
if (loading) {
  return (
    <SidebarProvider>
      <AppSidebar sections={[]} basePath="/va" roleLabel="VA" role="va" />
      <SidebarInset>
        <header className="flex h-14 shrink-0 items-center border-b border-border px-4">
          <Skeleton className="h-4 w-32" />
        </header>
        <div className="flex-1 p-8">
          <DashboardSkeleton />
        </div>
      </SidebarInset>
    </SidebarProvider>
  )
}
```

This renders the sidebar shell (empty sections) and a skeleton in the content area, so the page structure is recognizable during loading.

**File 2: `apps/web/src/components/admin/automation/jobs-table.tsx`**

Add import at top:
```typescript
import { TableSkeleton } from "@/components/skeletons/table-skeleton"
```

Replace lines 118-123 (the loading branch inside TableBody):
```typescript
// BEFORE (lines 118-123):
{loading && !jobs ? (
  <TableRow>
    <TableCell colSpan={5} className="text-center text-muted-foreground py-8">
      Loading...
    </TableCell>
  </TableRow>
)

// AFTER:
{loading && !jobs ? (
  <TableRow>
    <TableCell colSpan={5} className="p-0">
      <TableSkeleton columns={5} rows={5} />
    </TableCell>
  </TableRow>
)
```

**File 3: `apps/web/src/components/admin/automation/agents-table.tsx`**

Add import at top:
```typescript
import { TableSkeleton } from "@/components/skeletons/table-skeleton"
```

Replace lines 213-214 (the loading branch):
```typescript
// BEFORE (lines 213-214):
{loading && !agents ? (
  <div className="text-center text-muted-foreground py-8">Loading...</div>
)

// AFTER:
{loading && !agents ? (
  <div className="p-0">
    <TableSkeleton columns={6} rows={4} />
  </div>
)
```

**File 4: `apps/web/src/components/admin/automation/pairing-requests-table.tsx`**

Add import at top:
```typescript
import { TableSkeleton } from "@/components/skeletons/table-skeleton"
```

Replace lines 203-208 (the loading branch inside TableBody):
```typescript
// BEFORE (lines 203-208):
{loading && !requests ? (
  <TableRow>
    <TableCell colSpan={5} className="text-center text-muted-foreground py-8">
      Loading...
    </TableCell>
  </TableRow>
)

// AFTER:
{loading && !requests ? (
  <TableRow>
    <TableCell colSpan={5} className="p-0">
      <TableSkeleton columns={5} rows={3} />
    </TableCell>
  </TableRow>
)
```

IMPORTANT: Keep the `loading && !data` guard pattern -- do NOT change to just `loading`. This ensures cached data shows instantly on revisits.
  </action>
  <verify>
1. Run `cd /mnt/c/Users/User/Downloads/GitRepos/DS-ProSolution/apps/web && npx tsc --noEmit` to verify no type errors
2. Grep all 4 files for "Loading..." -- should find ZERO matches (the jobs-table, agents-table, pairing-requests-table, and va/layout.tsx)
3. Grep all 4 files for "TableSkeleton\|DashboardSkeleton" -- should find matches in each file
  </verify>
  <done>
- VA layout shows sidebar shell + DashboardSkeleton during role-check loading
- Jobs table shows TableSkeleton(columns=5, rows=5) during initial load
- Agents table shows TableSkeleton(columns=6, rows=4) during initial load
- Pairing requests table shows TableSkeleton(columns=5, rows=3) during initial load
- Zero "Loading..." text strings in any of the 4 files
  </done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `grep -rn "Loading\.\.\." apps/web/src/app/va/layout.tsx apps/web/src/components/admin/automation/jobs-table.tsx apps/web/src/components/admin/automation/agents-table.tsx apps/web/src/components/admin/automation/pairing-requests-table.tsx` returns empty
2. TypeScript compiles without errors
3. Each file imports and renders the correct skeleton component
</verification>

<success_criteria>
- All 4 page-level "Loading..." occurrences replaced with skeleton components
- No TypeScript compilation errors
- Loading guard pattern uses `loading && !data` (not just `loading`)
- SKEL-01 partially satisfied (4 of 5 legacy admin pages -- the 5th is the admin dashboard which already uses DashboardSkeleton)
- SKEL-03 partially satisfied (4 data-loading transitions converted)
</success_criteria>

<output>
After completion, create `.planning/phases/30-consistent-skeletons-empty-states/30-01-SUMMARY.md`
</output>

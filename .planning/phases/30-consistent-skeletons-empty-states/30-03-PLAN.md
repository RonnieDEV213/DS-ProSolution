---
phase: 30-consistent-skeletons-empty-states
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/components/admin/collection/log-detail-modal.tsx
  - apps/web/src/components/admin/account-dialog.tsx
  - apps/web/src/components/admin/department-role-dialog.tsx
  - apps/web/src/components/admin/user-edit-dialog.tsx
  - apps/web/src/components/data-management/import-history.tsx
autonomous: true

must_haves:
  truths:
    - "Log detail modal shows inline skeletons instead of 'Loading...' and 'Loading changes...' text"
    - "Account dialog shows inline skeleton instead of 'Loading...' text in the manage-VAs tab"
    - "Department role dialog shows inline skeletons instead of 'Loading profiles...' and 'Loading VAs...' text"
    - "User edit dialog shows inline skeleton instead of 'Loading profiles...' text"
    - "Import history shows inline skeleton instead of 'Loading import history...' text"
  artifacts:
    - path: "apps/web/src/components/admin/collection/log-detail-modal.tsx"
      provides: "Log detail modal with skeleton loading states"
      contains: "Skeleton"
    - path: "apps/web/src/components/admin/account-dialog.tsx"
      provides: "Account dialog with skeleton loading state in manage-VAs tab"
      contains: "Skeleton"
    - path: "apps/web/src/components/admin/department-role-dialog.tsx"
      provides: "Department role dialog with skeleton loading states"
      contains: "Skeleton"
    - path: "apps/web/src/components/admin/user-edit-dialog.tsx"
      provides: "User edit dialog with skeleton loading state"
      contains: "Skeleton"
    - path: "apps/web/src/components/data-management/import-history.tsx"
      provides: "Import history with skeleton loading state"
      contains: "Skeleton"
  key_links:
    - from: "log-detail-modal.tsx"
      to: "components/ui/skeleton.tsx"
      via: "import Skeleton primitive"
      pattern: "import.*Skeleton.*from.*ui/skeleton"
    - from: "account-dialog.tsx"
      to: "components/ui/skeleton.tsx"
      via: "import Skeleton primitive"
      pattern: "import.*Skeleton.*from.*ui/skeleton"
---

<objective>
Replace "Loading..." text in all modal/dialog components and import history with inline skeleton placeholders.

Purpose: Modals and dialogs are secondary loading contexts but still visible to users. Replacing text with skeletons ensures consistent loading behavior across the entire application. This plan eliminates the final 6 "Loading..." text occurrences (excluding the delete button which is action feedback, not data loading).
Output: 5 files updated with Skeleton imports and inline skeleton rendering.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/milestones/v5-ROADMAP.md
@.planning/STATE.md
@.planning/phases/30-consistent-skeletons-empty-states/30-RESEARCH.md
@apps/web/src/components/ui/skeleton.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace log detail modal and account dialog "Loading..." with skeletons</name>
  <files>
    apps/web/src/components/admin/collection/log-detail-modal.tsx
    apps/web/src/components/admin/account-dialog.tsx
  </files>
  <action>
**File 1: `apps/web/src/components/admin/collection/log-detail-modal.tsx`**

Add import at top:
```typescript
import { Skeleton } from "@/components/ui/skeleton"
```

Replace line 268 (main loading state):
```typescript
// BEFORE (line 267-268):
{loading ? (
  <div className="text-muted-foreground p-4">Loading...</div>
)

// AFTER:
{loading ? (
  <div className="grid grid-cols-2 gap-4 flex-1 min-h-0 animate-fade-in">
    {/* Left panel skeleton - changes list */}
    <div className="flex flex-col min-h-0">
      <Skeleton className="h-4 w-16 mb-2" />
      <div className="flex-1 rounded border border-border p-2 space-y-2">
        {Array.from({ length: 6 }).map((_, i) => (
          <div key={i} className="flex items-center gap-2 px-3 py-1.5">
            <Skeleton className="h-3.5 w-3.5" />
            <Skeleton className="h-3 flex-1" />
          </div>
        ))}
      </div>
    </div>
    {/* Right panel skeleton - history list */}
    <div className="flex flex-col min-h-0">
      <Skeleton className="h-4 w-20 mb-2" />
      <div className="flex-1 rounded border border-border space-y-0">
        {Array.from({ length: 8 }).map((_, i) => (
          <div key={i} className="px-3 py-2 border-b border-border last:border-0">
            <div className="flex items-center gap-2">
              <Skeleton className="h-4 w-4" />
              <Skeleton className="h-3 flex-1" />
            </div>
            <Skeleton className="h-2 w-28 mt-1" />
          </div>
        ))}
      </div>
    </div>
  </div>
)
```

This matches the two-panel layout: changes on the left, full history on the right.

Replace lines 277-278 (changes sub-section loading):
```typescript
// BEFORE (lines 277-278):
{changesLoading ? (
  <div className="text-muted-foreground text-sm">Loading changes...</div>
)

// AFTER:
{changesLoading ? (
  <div className="space-y-2 animate-fade-in">
    {Array.from({ length: 4 }).map((_, i) => (
      <div key={i} className="flex items-center gap-2 px-3 py-1.5 rounded border-l-2 border-border">
        <Skeleton className="h-3.5 w-3.5" />
        <Skeleton className="h-3 flex-1" />
      </div>
    ))}
  </div>
)
```

**File 2: `apps/web/src/components/admin/account-dialog.tsx`**

Add import at top:
```typescript
import { Skeleton } from "@/components/ui/skeleton"
```

Replace line 608 (manage-VAs tab loading):
```typescript
// BEFORE (line 607-608):
loadingAssignments ? (
  <p className="text-sm text-muted-foreground">Loading...</p>
)

// AFTER:
loadingAssignments ? (
  <div className="space-y-2 animate-fade-in">
    {Array.from({ length: 3 }).map((_, i) => (
      <div key={i} className="flex items-center justify-between p-3 rounded bg-muted">
        <Skeleton className="h-4 w-32" />
        <Skeleton className="h-7 w-16" />
      </div>
    ))}
  </div>
)
```

This matches the assignment list layout: name on left, remove button on right.

NOTE: Do NOT change line 476 (`loadingRecordsCount ? "Loading..." : "Delete Account"`). That is action feedback text inside a button, not a data-loading state. It is acceptable per SKEL-03.
  </action>
  <verify>
1. Grep `log-detail-modal.tsx` for the string `"Loading..."` -- should find ZERO matches
2. Grep `log-detail-modal.tsx` for "Loading changes" -- should find ZERO matches
3. Grep `account-dialog.tsx` for `"Loading..."` -- should find exactly ONE match (the delete button on line 476, which is intentionally kept)
4. Grep both files for "Skeleton" -- should find import and usage
  </verify>
  <done>
- Log detail modal shows two-panel skeleton layout during initial load
- Log detail modal shows inline change list skeleton during changes loading
- Account dialog shows assignment list skeleton in manage-VAs tab
- Delete button "Loading..." text is intentionally preserved (action feedback)
  </done>
</task>

<task type="auto">
  <name>Task 2: Replace department role dialog, user edit dialog, and import history "Loading..." with skeletons</name>
  <files>
    apps/web/src/components/admin/department-role-dialog.tsx
    apps/web/src/components/admin/user-edit-dialog.tsx
    apps/web/src/components/data-management/import-history.tsx
  </files>
  <action>
**File 1: `apps/web/src/components/admin/department-role-dialog.tsx`**

Add import at top:
```typescript
import { Skeleton } from "@/components/ui/skeleton"
```

Replace line 622-623 (profiles list loading in "all-profiles" tab):
```typescript
// BEFORE (line 622-623):
{loadingRoles ? (
  <p className="text-muted-foreground text-center py-8">Loading profiles...</p>
)

// AFTER:
{loadingRoles ? (
  <div className="space-y-1 animate-fade-in">
    {Array.from({ length: 4 }).map((_, i) => (
      <div key={i} className="p-3 rounded-lg bg-muted/50 border-l-3 border-l-transparent">
        <div className="flex items-center justify-between">
          <Skeleton className="h-4 w-28" />
          <Skeleton className="h-3 w-12" />
        </div>
        <Skeleton className="h-2 w-24 mt-1.5" />
      </div>
    ))}
  </div>
)
```

This matches the profile list items: name + VA count, created date.

Replace line 765-766 (VAs list loading in "manage-vas" tab):
```typescript
// BEFORE (line 765-766):
{loadingVAs ? (
  <p className="text-muted-foreground">Loading VAs...</p>
)

// AFTER:
{loadingVAs ? (
  <div className="space-y-2 animate-fade-in">
    {Array.from({ length: 4 }).map((_, i) => (
      <div key={i} className="flex items-center gap-3 p-3 rounded bg-muted">
        <Skeleton className="h-4 w-4 rounded" />
        <div className="flex-1">
          <Skeleton className="h-4 w-28" />
          <Skeleton className="h-3 w-36 mt-1" />
        </div>
      </div>
    ))}
  </div>
)
```

This matches the VA checkbox list: checkbox + name + email.

**File 2: `apps/web/src/components/admin/user-edit-dialog.tsx`**

Add import at top:
```typescript
import { Skeleton } from "@/components/ui/skeleton"
```

Replace line 549-550 (access profiles tab loading):
```typescript
// BEFORE (line 549-550):
{loadingDeptRoles ? (
  <p className="text-sm text-muted-foreground">Loading profiles...</p>
)

// AFTER:
{loadingDeptRoles ? (
  <div className="space-y-2 animate-fade-in">
    {Array.from({ length: 3 }).map((_, i) => (
      <div key={i} className="flex items-center gap-3 p-3 rounded bg-muted">
        <Skeleton className="h-4 w-4 rounded" />
        <div className="flex-1">
          <Skeleton className="h-4 w-32" />
          <Skeleton className="h-3 w-48 mt-1" />
        </div>
      </div>
    ))}
  </div>
)
```

This matches the profile checkbox list: checkbox + name + description.

**File 3: `apps/web/src/components/data-management/import-history.tsx`**

Add import at top:
```typescript
import { Skeleton } from "@/components/ui/skeleton"
```

Replace lines 88-93 (loading guard):
```typescript
// BEFORE (lines 88-93):
if (isLoading) {
  return (
    <div className="text-center py-8 text-muted-foreground">
      Loading import history...
    </div>
  );
}

// AFTER:
if (isLoading) {
  return (
    <div className="space-y-3 animate-fade-in">
      {Array.from({ length: 3 }).map((_, i) => (
        <div key={i} className="rounded-md border border-border p-4 space-y-2">
          <div className="flex items-center justify-between">
            <Skeleton className="h-4 w-40" />
            <Skeleton className="h-5 w-16 rounded-full" />
          </div>
          <Skeleton className="h-3 w-56" />
          <div className="flex items-center gap-4">
            <Skeleton className="h-3 w-20" />
            <Skeleton className="h-3 w-24" />
          </div>
        </div>
      ))}
    </div>
  );
}
```

This matches the import history card list: filename + badge, description, metadata row.
  </action>
  <verify>
1. Grep `department-role-dialog.tsx` for "Loading profiles\|Loading VAs" -- should find ZERO matches
2. Grep `user-edit-dialog.tsx` for "Loading profiles" -- should find ZERO matches
3. Grep `import-history.tsx` for "Loading import history" -- should find ZERO matches
4. Grep all 3 files for "Skeleton" -- should find import and usage
5. Run `cd /mnt/c/Users/User/Downloads/GitRepos/DS-ProSolution/apps/web && npx tsc --noEmit` to verify no type errors
  </verify>
  <done>
- Department role dialog shows profile list skeleton in "all-profiles" tab
- Department role dialog shows VA checkbox list skeleton in "manage-vas" tab
- User edit dialog shows profile checkbox list skeleton in "access-profiles" tab
- Import history shows card list skeleton during loading
- Zero "Loading..." text strings in any of the 3 files' loading branches
  </done>
</task>

</tasks>

<verification>
After all tasks complete:
1. Run comprehensive grep across ALL modified files to ensure no "Loading..." text remains (except the intentional delete button in account-dialog.tsx line 476)
2. TypeScript compiles without errors
3. All 5 files import and use `Skeleton` from `@/components/ui/skeleton`
</verification>

<success_criteria>
- All 6 modal/dialog "Loading..." occurrences replaced (2 in log-detail-modal, 1 in account-dialog, 2 in department-role-dialog, 1 in user-edit-dialog)
- Import history "Loading..." occurrence replaced
- Only the delete button "Loading..." text in account-dialog.tsx remains (intentionally, as action feedback)
- No TypeScript compilation errors
- SKEL-03 progress: 6 more data-loading transitions converted
</success_criteria>

<output>
After completion, create `.planning/phases/30-consistent-skeletons-empty-states/30-03-SUMMARY.md`
</output>

---
phase: 26-polish-micro-interactions
plan: 03
type: execute
wave: 2
depends_on: ["26-01"]
files_modified:
  - apps/web/src/components/ui/skeleton.tsx
  - apps/web/src/components/skeletons/dashboard-skeleton.tsx
  - apps/web/src/components/skeletons/table-skeleton.tsx
  - apps/web/src/components/skeletons/card-grid-skeleton.tsx
  - apps/web/src/components/bookkeeping/skeleton-row.tsx
autonomous: true

must_haves:
  truths:
    - "Skeleton components use CSS shimmer animation (not pulse)"
    - "Dashboard skeleton matches card grid + metrics layout"
    - "Table skeleton matches column structure with header + rows"
    - "Existing SkeletonRow is upgraded from pulse to shimmer"
    - "Skeletons respect prefers-reduced-motion (fallback to static muted)"
  artifacts:
    - path: "apps/web/src/components/ui/skeleton.tsx"
      provides: "Base Skeleton primitive with shimmer"
      exports: ["Skeleton"]
    - path: "apps/web/src/components/skeletons/dashboard-skeleton.tsx"
      provides: "Dashboard page loading skeleton"
      exports: ["DashboardSkeleton"]
    - path: "apps/web/src/components/skeletons/table-skeleton.tsx"
      provides: "Data table loading skeleton"
      exports: ["TableSkeleton"]
    - path: "apps/web/src/components/skeletons/card-grid-skeleton.tsx"
      provides: "Card grid loading skeleton"
      exports: ["CardGridSkeleton"]
  key_links:
    - from: "skeleton.tsx"
      to: "globals.css"
      via: "skeleton-shimmer CSS class"
      pattern: "skeleton-shimmer"
---

<objective>
Create high-fidelity skeleton loading components that match the exact structure of each page type, using CSS shimmer animation.

Purpose: Replace jarring content pop-in with smooth skeleton loading states (POLISH-06). Skeletons match page layouts so users perceive faster loading.

Output: Base Skeleton primitive, page-specific skeleton components for dashboard/table/card-grid, upgraded existing SkeletonRow.
</objective>

<execution_context>
@C:\Users\User\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\User\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@apps/web/src/app/globals.css
@apps/web/src/components/bookkeeping/skeleton-row.tsx
@.planning/phases/26-polish-micro-interactions/26-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create base Skeleton primitive and page-specific skeleton components</name>
  <files>apps/web/src/components/ui/skeleton.tsx, apps/web/src/components/skeletons/dashboard-skeleton.tsx, apps/web/src/components/skeletons/table-skeleton.tsx, apps/web/src/components/skeletons/card-grid-skeleton.tsx</files>
  <action>
1. **Create `apps/web/src/components/ui/skeleton.tsx`** - Base skeleton primitive:

```tsx
import { cn } from "@/lib/utils"

function Skeleton({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) {
  return (
    <div
      className={cn("skeleton-shimmer rounded-md", className)}
      {...props}
    />
  )
}

export { Skeleton }
```

Uses the `.skeleton-shimmer` class from globals.css (Plan 01) which provides:
- CSS gradient shimmer animation (2s, ease-in-out, infinite)
- Theme-aware colors via var(--muted)
- prefers-reduced-motion fallback (static muted bg)

2. **Create `apps/web/src/components/skeletons/dashboard-skeleton.tsx`**:

Match the dashboard layout: page header + metrics cards row + main content area.

```tsx
import { Skeleton } from "@/components/ui/skeleton"

export function DashboardSkeleton() {
  return (
    <div className="space-y-6 animate-fade-in">
      {/* Page header */}
      <div className="space-y-2">
        <Skeleton className="h-8 w-48" />
        <Skeleton className="h-4 w-72" />
      </div>

      {/* Metrics cards row */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        {Array.from({ length: 4 }).map((_, i) => (
          <div key={i} className="rounded-lg border border-border p-6 space-y-3">
            <Skeleton className="h-4 w-24" />
            <Skeleton className="h-8 w-16" />
            <Skeleton className="h-3 w-32" />
          </div>
        ))}
      </div>

      {/* Main content area */}
      <div className="rounded-lg border border-border p-6 space-y-4">
        <Skeleton className="h-6 w-36" />
        <div className="space-y-3">
          {Array.from({ length: 5 }).map((_, i) => (
            <Skeleton key={i} className="h-12 w-full" />
          ))}
        </div>
      </div>
    </div>
  )
}
```

3. **Create `apps/web/src/components/skeletons/table-skeleton.tsx`**:

Match the data table layout: toolbar + header row + data rows.

```tsx
import { Skeleton } from "@/components/ui/skeleton"

interface TableSkeletonProps {
  columns?: number
  rows?: number
}

export function TableSkeleton({ columns = 6, rows = 8 }: TableSkeletonProps) {
  return (
    <div className="space-y-4 animate-fade-in">
      {/* Toolbar area */}
      <div className="flex items-center justify-between">
        <div className="flex items-center gap-2">
          <Skeleton className="h-9 w-64" /> {/* Search input */}
          <Skeleton className="h-9 w-24" /> {/* Filter button */}
        </div>
        <Skeleton className="h-9 w-28" /> {/* Action button */}
      </div>

      {/* Table */}
      <div className="rounded-lg border border-border overflow-hidden">
        {/* Header row */}
        <div className="flex items-center gap-4 px-4 h-10 bg-muted/50 border-b border-border">
          {Array.from({ length: columns }).map((_, i) => (
            <Skeleton key={i} className="h-3 flex-1 max-w-[120px]" />
          ))}
        </div>

        {/* Data rows */}
        {Array.from({ length: rows }).map((_, i) => (
          <div key={i} className="flex items-center gap-4 px-4 h-12 border-b border-border last:border-b-0">
            {Array.from({ length: columns }).map((_, j) => (
              <Skeleton key={j} className="h-3 flex-1 max-w-[120px]" />
            ))}
          </div>
        ))}
      </div>

      {/* Pagination */}
      <div className="flex items-center justify-between">
        <Skeleton className="h-4 w-32" />
        <div className="flex gap-2">
          <Skeleton className="h-8 w-8" />
          <Skeleton className="h-8 w-8" />
        </div>
      </div>
    </div>
  )
}
```

4. **Create `apps/web/src/components/skeletons/card-grid-skeleton.tsx`**:

Match the card grid layout used by accounts, users pages.

```tsx
import { Skeleton } from "@/components/ui/skeleton"

interface CardGridSkeletonProps {
  cards?: number
  columns?: string
}

export function CardGridSkeleton({
  cards = 6,
  columns = "grid-cols-1 md:grid-cols-2 lg:grid-cols-3",
}: CardGridSkeletonProps) {
  return (
    <div className="space-y-6 animate-fade-in">
      {/* Page header */}
      <div className="flex items-center justify-between">
        <div className="space-y-2">
          <Skeleton className="h-8 w-48" />
          <Skeleton className="h-4 w-64" />
        </div>
        <Skeleton className="h-9 w-32" />
      </div>

      {/* Card grid */}
      <div className={`grid ${columns} gap-4`}>
        {Array.from({ length: cards }).map((_, i) => (
          <div key={i} className="rounded-lg border border-border p-6 space-y-4">
            <div className="flex items-center gap-3">
              <Skeleton className="h-10 w-10 rounded-full" />
              <div className="space-y-2 flex-1">
                <Skeleton className="h-4 w-32" />
                <Skeleton className="h-3 w-24" />
              </div>
            </div>
            <Skeleton className="h-3 w-full" />
            <Skeleton className="h-3 w-3/4" />
          </div>
        ))}
      </div>
    </div>
  )
}
```

All skeleton components:
- Use `animate-fade-in` class (from Plan 01) for entry animation
- Use `border-border` for theme-compatible borders
- Use the Skeleton primitive which provides shimmer animation
- Match proportions of their real content counterparts
- Are reusable with configurable row/column/card counts
  </action>
  <verify>
Run `npm run build` in apps/web. Verify all 4 skeleton component files exist and export their components. Check TypeScript compiles clean.
  </verify>
  <done>
Base Skeleton primitive uses CSS shimmer. DashboardSkeleton matches metrics + table layout. TableSkeleton matches toolbar + header + rows + pagination. CardGridSkeleton matches card grid with avatars and text.
  </done>
</task>

<task type="auto">
  <name>Task 2: Upgrade existing SkeletonRow from pulse to shimmer</name>
  <files>apps/web/src/components/bookkeeping/skeleton-row.tsx</files>
  <action>
Update the existing SkeletonRow component to use the CSS shimmer animation instead of `animate-pulse`.

Current pattern (every cell):
```tsx
<div className="h-3 w-20 bg-muted rounded animate-pulse" />
```

Replace all `bg-muted rounded animate-pulse` occurrences with `skeleton-shimmer rounded`:
```tsx
<div className="h-3 w-20 skeleton-shimmer rounded" />
```

The `.skeleton-shimmer` class (from globals.css, Plan 01) provides:
- Theme-aware gradient shimmer animation
- prefers-reduced-motion fallback to static bg
- 2s ease-in-out infinite animation

This preserves the existing component structure (same heights, widths, layout) while upgrading the visual effect from pulse to shimmer.

Apply the change to ALL skeleton cells in the component (there are approximately 11 skeleton divs). Each one should have `bg-muted rounded animate-pulse` replaced with `skeleton-shimmer rounded`.
  </action>
  <verify>
Run `npm run build` in apps/web. Verify skeleton-row.tsx no longer contains `animate-pulse` and uses `skeleton-shimmer` instead. Check the component still accepts style and density props.
  </verify>
  <done>
SkeletonRow uses shimmer animation instead of pulse. All skeleton cells use the skeleton-shimmer class. Component API (style, density props) unchanged.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` passes with no errors
2. `apps/web/src/components/ui/skeleton.tsx` exports Skeleton primitive
3. Three page-specific skeletons exist in `apps/web/src/components/skeletons/`
4. Existing SkeletonRow uses shimmer, not pulse
5. All skeletons use theme-aware CSS classes (no hardcoded colors)
</verification>

<success_criteria>
- Skeleton loading states available for dashboard, table, and card grid layouts
- All skeletons use CSS shimmer animation (perceived 35% faster than pulse)
- Existing SkeletonRow upgraded to match new shimmer style
- Components are composable and configurable (row/column/card counts)
- Zero runtime JS overhead (pure CSS animation)
</success_criteria>

<output>
After completion, create `.planning/phases/26-polish-micro-interactions/26-03-SUMMARY.md`
</output>

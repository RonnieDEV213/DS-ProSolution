---
phase: 04.1-auto-order-tab-organization
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/extension/sidepanel.html
  - packages/extension/sidepanel.css
  - packages/extension/sidepanel.js
autonomous: true

must_haves:
  truths:
    - "Auto Order tab appears in extension for admins and VAs with auto_order.read"
    - "Profile section (name, type badge, Clock Out) displays below tab bar"
    - "Agent info section (Label, Account, Role) displays below profile section"
    - "Stats, task, attention, queue, actions, hotkeys only show in Auto Order tab"
    - "Switching tabs hides Auto Order content and shows tab placeholder"
  artifacts:
    - path: "packages/extension/sidepanel.html"
      provides: "Reorganized hub layout with persistent sections"
      contains: "auto-order-content"
    - path: "packages/extension/sidepanel.js"
      provides: "Auto Order tab in ADMIN_TABS and tab content switching"
      contains: "auto_order"
  key_links:
    - from: "sidepanel.js ADMIN_TABS"
      to: "sidepanel.html #auto-order-content"
      via: "showTabContent() conditional rendering"
      pattern: "auto_order"
    - from: "sidepanel.js renderHub()"
      to: "profile-section, agent-info-card"
      via: "persistent section rendering"
      pattern: "renderProfileSection|agent-info"
---

<objective>
Reorganize extension hub layout: tabs at top, persistent profile/agent sections, Auto Order content as tab-specific.

Purpose: Establish clear separation between persistent information (who you are, what account) and tab-specific features (auto ordering controls). Users always see their identity and context regardless of which tab they're viewing.

Output: Extension hub with reorganized layout and Auto Order tab for automation features.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04.1-auto-order-tab-organization/04.1-CONTEXT.md
@.planning/phases/04-extension-rbac/04-01-SUMMARY.md

@packages/extension/sidepanel.html
@packages/extension/sidepanel.css
@packages/extension/sidepanel.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Reorganize HTML layout for persistent sections and Auto Order content</name>
  <files>packages/extension/sidepanel.html</files>
  <action>
Reorganize the hub-section layout. Current order is: profile -> tabs -> tab-content -> agent-info -> stats -> etc.
New order should be: tabs -> profile -> agent-info -> tab-content (which contains auto order stuff).

Inside `#hub-section`:

1. **Keep tab bar at top** (already there - no change to tab-bar position)

2. **Move profile section BELOW tab bar** (it's currently above tabs):
   - The profile-section stays the same structure
   - Just reorder in HTML so it comes after tab-bar

3. **Move agent-info-card BELOW profile section**:
   - This section already exists, just reorder it

4. **Wrap all Auto Order content in a container**:
   - Create a new div with id="auto-order-content" and class="auto-order-content hidden"
   - Move these sections INSIDE that container:
     - Stats section (class="section stats")
     - Current Task section (#current-task-section)
     - Attention section (#attention-section)
     - Queue section (class="section queue")
     - Quick Actions section (class="section actions")
     - Hotkeys section (class="section hotkeys")

5. **Keep tab-content AFTER auto-order-content**:
   - The tab-content div shows placeholder for non-Auto-Order tabs
   - Auto Order tab will hide tab-content and show auto-order-content

6. **Keep empty-state where it is** (for VAs with no roles)

Final order inside #hub-section should be:
```
nav#tab-bar
nav#tab-bar-skeleton
section.profile-section
section.agent-info-card
div#auto-order-content (contains: stats, current-task, attention, queue, actions, hotkeys)
div#tab-content
section#empty-state
```
  </action>
  <verify>
Run: `grep -n "hub-section\|tab-bar\|profile-section\|agent-info-card\|auto-order-content\|tab-content\|empty-state" /mnt/c/Users/User/Downloads/GitRepos/DS-ProSolution/packages/extension/sidepanel.html | head -30`
Verify order: tab-bar appears before profile-section, profile-section before agent-info-card, agent-info-card before auto-order-content.
  </verify>
  <done>HTML structure reorganized with tabs -> profile -> agent -> auto-order-content -> tab-content order</done>
</task>

<task type="auto">
  <name>Task 2: Update JavaScript for Auto Order tab and content switching</name>
  <files>packages/extension/sidepanel.js</files>
  <action>
Update sidepanel.js to handle Auto Order tab and content switching:

1. **Add Auto Order to ADMIN_TABS** (around line 19):
   - Add as FIRST item: `{ id: 'auto_order', name: 'Auto Order', icon: 'ðŸ¤–' }`
   - Keep Order Tracking and Accounts after it

2. **Add Auto Order to ROLE_ICONS** (around line 25):
   - Add: `'Auto Order': 'ðŸ¤–'`

3. **Add element reference for auto-order-content** in elements object:
   - Add: `autoOrderContent: document.getElementById('auto-order-content')`

4. **Update showTabContent() function** to handle Auto Order:
   ```javascript
   function showTabContent(tabId, tabName) {
     // Show/hide Auto Order content based on tab
     if (tabId === 'auto_order') {
       elements.autoOrderContent?.classList.remove('hidden');
       elements.tabContent?.classList.add('hidden');
     } else {
       elements.autoOrderContent?.classList.add('hidden');
       elements.tabContent?.classList.remove('hidden');
       // Show placeholder for other tabs
       if (elements.tabContent) {
         elements.tabContent.innerHTML = `
           <p class="tab-placeholder">${escapeHtml(tabName || tabId)} feature content will appear here</p>
         `;
       }
     }
   }
   ```

5. **Update renderHub() to show Auto Order content by default**:
   - After renderTabs(), the first tab (Auto Order for admins) will trigger showTabContent()
   - Ensure auto-order-content is visible when Auto Order tab is active
   - Keep existing renderHub() logic for stats, task, attention, queue, buttons

6. **Update hideAllSections() to also hide auto-order-content**:
   - Add: `elements.autoOrderContent?.classList.add('hidden');`

This ensures:
- Admins see Auto Order as first tab (with robot emoji)
- VAs with auto_order.read permission in their roles see Auto Order tab
- Selecting Auto Order shows the automation controls
- Selecting other tabs shows placeholder
  </action>
  <verify>
Run: `grep -n "auto_order\|autoOrderContent" /mnt/c/Users/User/Downloads/GitRepos/DS-ProSolution/packages/extension/sidepanel.js | head -20`
Verify: auto_order in ADMIN_TABS, autoOrderContent in elements, showTabContent handles auto_order case.
  </verify>
  <done>JavaScript handles Auto Order tab selection and shows/hides appropriate content</done>
</task>

<task type="auto">
  <name>Task 3: Add CSS for auto-order-content container</name>
  <files>packages/extension/sidepanel.css</files>
  <action>
Add minimal CSS for the auto-order-content container:

```css
/* Auto Order tab content container */
.auto-order-content {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.auto-order-content.hidden {
  display: none;
}
```

Place this near other hub section styles (around line 150-200 area where .tab-content styles are).

The existing section styles (.section.stats, .current-task, etc.) remain unchanged - they just need to be inside the container now.
  </action>
  <verify>
Run: `grep -n "auto-order-content" /mnt/c/Users/User/Downloads/GitRepos/DS-ProSolution/packages/extension/sidepanel.css`
Verify: CSS class exists for auto-order-content.
  </verify>
  <done>CSS styles added for auto-order-content container</done>
</task>

</tasks>

<verification>
After all tasks:
1. Load extension side panel
2. Admin should see: Tab bar (Auto Order first) -> Profile section -> Agent info -> Auto Order controls (stats, task, attention, queue, actions, hotkeys)
3. Click "Order Tracking" tab -> Auto Order controls hidden, placeholder shown
4. Click "Auto Order" tab -> Auto Order controls visible, placeholder hidden
5. Profile section and Agent info remain visible regardless of which tab is active
</verification>

<success_criteria>
- Extension hub shows tabs at top, profile below tabs, agent info below profile
- Auto Order tab (robot emoji) appears first for admins
- Auto Order content (stats, task, attention, queue, actions, hotkeys) only shows when Auto Order tab is active
- Other tabs show placeholder text
- Profile and agent info sections are persistent (visible on all tabs)
</success_criteria>

<output>
After completion, create `.planning/phases/04.1-auto-order-tab-organization/04.1-02-SUMMARY.md`
</output>
